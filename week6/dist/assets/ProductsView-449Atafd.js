import{a as h}from"./axios-G2rPRu76.js";import{M as k}from"./bootstrap.esm-TTjMTX3M.js";import{_ as b,o as a,c as d,a as t,t as l,g as u,h as M,v as S,F as v,i as y,b as I,r as $,n as C,d as p,p as P,j as x}from"./index-WEw7Lc65.js";const w={props:["product"],data(){return{status:{},productModal:"",qty:1}},mounted(){this.productModal=new k(this.$refs.modal,{keyboard:!1,backdrop:"static"})},methods:{openModal(){this.productModal.show()},hideModal(){this.productModal.hide()}},watch:{product(){this.qty=1}}},T={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},V={class:"modal-dialog modal-xl",role:"document"},U={class:"modal-content border-0"},A={class:"modal-header bg-dark text-white"},E={class:"modal-title",id:"exampleModalLabel"},L=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),q={class:"modal-body"},D={class:"row"},R={class:"col-sm-6"},B=["src"],N={class:"col-sm-6"},z={class:"badge bg-primary rounded-pill"},F={key:0,class:"h5"},H={key:1},O={key:0,class:"h6"},j={key:1,class:"h5"},G={class:"input-group"},J=["value"];function K(e,i,s,c,n,_){return a(),d("div",T,[t("div",V,[t("div",U,[t("div",A,[t("h5",E,[t("span",null,l(s.product.title),1)]),L]),t("div",q,[t("div",D,[t("div",R,[t("img",{class:"img-fluid",src:s.product.imageUrl,alt:""},null,8,B)]),t("div",N,[t("span",z,l(s.product.category),1),t("p",null,"商品描述："+l(s.product.description),1),t("p",null,"商品內容："+l(s.product.content),1),s.product.origin_price===s.product.price?(a(),d("div",F,l(s.product.origin_price)+" 元",1)):(a(),d("div",H,[s.product.price?(a(),d("del",O,"原價 "+l(s.product.origin_price)+" 元",1)):u("",!0),s.product.price?(a(),d("div",j,"現在只要 "+l(s.product.price)+" 元",1)):u("",!0)])),t("div",null,[t("div",G,[M(t("select",{name:"",id:"",class:"form-select","onUpdate:modelValue":i[0]||(i[0]=r=>n.qty=r)},[(a(),d(v,null,y(20,r=>t("option",{value:r,key:r},l(r),9,J)),64))],512),[[S,n.qty,void 0,{number:!0}]]),t("button",{type:"button",class:"btn btn-primary",onClick:i[1]||(i[1]=r=>e.$emit("add-to-cart",s.product.id,n.qty))},"加入購物車")])])])])])])])],512)}const Q=b(w,[["render",K]]);var W={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"ryanpro",BASE_URL:"//vue_winter_practise/week6/dist//",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_URL:g,VITE_APP_PATH:m}=W,X={data(){return{loadingStatus:{loadingItem:""},products:[],product:{},cart:{},isLoading:!0}},methods:{getProducts(){h.get(`${g}/api/${m}/products`).then(e=>{this.products=e.data.products,this.isLoading=!1}).catch(e=>{alert(e.res.data.message)})},getProduct(e){this.loadingStatus.loadingItem=e,h.get(`${g}/api/${m}/product/${e}`).then(i=>{this.loadingStatus.loadingItem="",this.product=i.data.product,this.$refs.userModal.openModal()}).catch(i=>{alert(i.res.data.message)})},addToCart(e,i=1){this.loadingStatus.loadingItem=e;const s={product_id:e,qty:i};this.$refs.userModal.hideModal(),h.post(`${g}/api/${m}/cart`,{data:s}).then(c=>{alert(c.data.message),this.loadingStatus.loadingItem="",this.getCart()}).catch(c=>{alert(c.res.data.message)})},changeCart(e,i){this.loadingStatus.loadingItem=e.id;const s={product_id:e.product_id,qty:i};console.log(s),h.put(`${g}/api/${m}/cart/${e.id}`,{data:s}).then(c=>{alert(c.data.message),this.loadingStatus.loadingItem="",this.getCart()}).catch(c=>{alert(c.res.data.message),this.loadingStatus.loadingItem=""})}},mounted(){this.getProducts()},components:{UserModal:Q}},Y=e=>(P("data-v-3a3a4c30"),e=e(),x(),e),Z={class:"container"},tt={class:"row mt-3"},et={class:"table align-middle"},st=Y(()=>t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"商品名稱"),t("th",null,"價格"),t("th")])],-1)),ot={style:{width:"200px"}},at={key:0,class:"h5"},dt={key:1},it={key:0,class:"h6"},lt={key:1,class:"h5"},nt={class:"btn-group btn-group-sm"},ct=["onClick","disabled"],rt={key:0,class:"fas fa-spinner fa-pulse"},ut=["onClick","disabled"],_t={key:0,class:"fas fa-spinner fa-pulse"};function ht(e,i,s,c,n,_){const r=$("UserModal");return a(),d("div",Z,[t("div",tt,[I(r,{ref:"userModal",product:n.product,onAddToCart:_.addToCart},null,8,["product","onAddToCart"]),t("table",et,[st,t("tbody",null,[(a(!0),d(v,null,y(n.products,o=>(a(),d("tr",{key:o.id},[t("td",ot,[!o.imageUrl==""?(a(),d("div",{key:0,style:C([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${o.imageUrl})`}])},null,4)):u("",!0)]),t("td",null,l(o.title),1),t("td",null,[o.origin_price===o.price?(a(),d("div",at,l(o.origin_price)+" 元",1)):(a(),d("div",dt,[o.price?(a(),d("del",it,"原價 "+l(o.origin_price)+" 元",1)):u("",!0),o.price?(a(),d("div",lt,"現在只要 "+l(o.price)+" 元",1)):u("",!0)]))]),t("td",null,[t("div",nt,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:f=>_.getProduct(o.id),disabled:o.id===n.loadingStatus.loadingItem||!o.is_enabled},[n.loadingStatus.loadingItem===o.id?(a(),d("i",rt)):u("",!0),p(" 查看更多 ")],8,ct),t("button",{type:"button",class:"btn btn-outline-danger",onClick:f=>_.addToCart(o.id),disabled:o.id===n.loadingStatus.loadingItem||!o.is_enabled},[n.loadingStatus.loadingItem===o.id?(a(),d("i",_t)):u("",!0),p(" 加到購物車 ")],8,ut)])])]))),128))])])])])}const bt=b(X,[["render",ht],["__scopeId","data-v-3a3a4c30"]]);export{bt as default};
